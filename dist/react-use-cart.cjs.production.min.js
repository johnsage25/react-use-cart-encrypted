"use strict";var t=require("react");function e(){return(e=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}).apply(this,arguments)}var r=require("secure-ls");function n(e,n){var a=t.useState((function(){try{var t=new r;return void 0!==t&&t.get(e)||n}catch(t){return n}})),i=a[0],o=a[1];return[i,function(t){try{var n=new r,a=t instanceof Function?t(i):t;o(a),n.set(e,a)}catch(t){console.log(t)}}]}var a={items:[],isEmpty:!0,totalItems:0,totalUniqueItems:0,cartTotal:0,metadata:{}},i=t.createContext(a),o=function(t){return void 0===t&&(t=12),[].concat(Array(t)).map((function(){return(~~(36*Math.random())).toString(36)})).join("")};function u(t,r){switch(r.type){case"SET_ITEMS":return c(t,r.payload);case"ADD_ITEM":var n=[].concat(t.items,[r.payload]);return c(t,n);case"UPDATE_ITEM":var i=t.items.map((function(t){return t.id!==r.id?t:e({},t,r.payload)}));return c(t,i);case"REMOVE_ITEM":var o=t.items.filter((function(t){return t.id!==r.id}));return c(t,o);case"EMPTY_CART":return a;case"CLEAR_CART_META":return e({},t,{metadata:{}});case"SET_CART_META":return e({},t,{metadata:e({},r.payload)});case"UPDATE_CART_META":return e({},t,{metadata:e({},t.metadata,r.payload)});default:throw new Error("No action specified")}}var c=function(t,r){void 0===t&&(t=a);var n=p(r),i=0===n;return e({},a,t,{items:d(r),totalItems:f(r),totalUniqueItems:n,cartTotal:s(r),isEmpty:i})},d=function(t){return t.map((function(t){return e({},t,{itemTotal:t.price*t.quantity})}))},s=function(t){return t.reduce((function(t,e){return t+e.quantity*e.price}),0)},f=function(t){return t.reduce((function(t,e){return t+e.quantity}),0)},p=function(t){return t.length};exports.CartProvider=function(r){var c=r.children,d=r.id,s=r.defaultItems,f=void 0===s?[]:s,p=r.onSetItems,m=r.onItemAdd,E=r.onItemUpdate,y=r.onItemRemove,T=r.storage,v=void 0===T?n:T,l=r.metadata,I=d||o(),A=v(d?"react-use-cart-"+I:"react-use-cart",JSON.stringify(e({id:I},a,{items:f,metadata:l}))),M=A[1],_=t.useReducer(u,JSON.parse(A[0])),C=_[0],w=_[1];return t.useEffect((function(){M(JSON.stringify(C))}),[C,M]),t.createElement(i.Provider,{value:e({},C,{getItem:function(t){return C.items.find((function(e){return e.id===t}))},inCart:function(t){return C.items.some((function(e){return e.id===t}))},setItems:function(t){w({type:"SET_ITEMS",payload:t.map((function(t){return e({},t,{quantity:t.quantity||1})}))}),p&&p(t)},addItem:function(t,r){if(void 0===r&&(r=1),!t.id)throw new Error("You must provide an `id` for items");if(!(r<=0)){var n=C.items.find((function(e){return e.id===t.id}));if(!n&&!t.hasOwnProperty("price"))throw new Error("You must pass a `price` for new items");if(!n){var a=e({},t,{quantity:r});return w({type:"ADD_ITEM",payload:a}),void(m&&m(a))}var i=e({},t,{quantity:n.quantity+r});w({type:"UPDATE_ITEM",id:t.id,payload:i}),E&&E(i)}},updateItem:function(t,e){t&&e&&(w({type:"UPDATE_ITEM",id:t,payload:e}),E&&E(e))},updateItemQuantity:function(t,r){if(r<=0)return y&&y(t),void w({type:"REMOVE_ITEM",id:t});var n=C.items.find((function(e){return e.id===t}));if(!n)throw new Error("No such item to update");var a=e({},n,{quantity:r});w({type:"UPDATE_ITEM",id:t,payload:a}),E&&E(a)},removeItem:function(t){t&&(w({type:"REMOVE_ITEM",id:t}),y&&y(t))},emptyCart:function(){return w({type:"EMPTY_CART"})},clearCartMetadata:function(){w({type:"CLEAR_CART_META"})},setCartMetadata:function(t){t&&w({type:"SET_CART_META",payload:t})},updateCartMetadata:function(t){t&&w({type:"UPDATE_CART_META",payload:t})}})},c)},exports.createCartIdentifier=o,exports.initialState=a,exports.useCart=function(){var e=t.useContext(i);if(!e)throw new Error("Expected to be wrapped in a CartProvider");return e};
//# sourceMappingURL=react-use-cart.cjs.production.min.js.map
